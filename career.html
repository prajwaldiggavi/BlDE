<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Management</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

    <h1>Student Management System</h1>

    <!-- Add Student Form -->
    <form id="studentForm">
        <input type="text" id="studentId" placeholder="Student ID" required><br>
        <input type="text" id="studentName" placeholder="Student Name" required><br>
        <input type="text" id="semester" placeholder="Semester" required><br>
        <input type="text" id="phone_number" placeholder="Phone Number" required><br>
        <input type="email" id="email" placeholder="Email" required><br>
        <input type="date" id="dob" placeholder="Date of Birth" required><br>
        <select id="gender" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
        </select><br>
        <button type="button" onclick="addStudent()">Add Student</button>
    </form>

    <!-- Show Students by Semester -->
    <h2>View Students by Semester</h2>
    <input type="text" id="showSemester" placeholder="Enter Semester">
    <button type="button" onclick="showStudents()">Show Students</button>

    <table id="studentList" border="1">
        <thead>
            <tr>
                <th>Student ID</th>
                <th>Student Name</th>
                <th>Semester</th>
                <th>Phone Number</th>
                <th>Email</th>
                <th>Date of Birth</th>
                <th>Gender</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        const serverUrl = 'https://blde-production.up.railway.app'; // Your Railway app URL

        function addStudent() {
            const studentId = $('#studentId').val();
            const studentName = $('#studentName').val();
            const semester = $('#semester').val();
            const phone_number = $('#phone_number').val();
            const email = $('#email').val();
            const dob = $('#dob').val();
            const gender = $('#gender').val();

            if (studentId && studentName && semester && phone_number && email && dob && gender) {
                $.ajax({
                    url: `${serverUrl}/add-student`,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ studentId, studentName, semester, phone_number, email, dob, gender }),
                    success: function(response) {
                        alert(response);
                        $('#studentForm')[0].reset(); // Clear the form
                    },
                    error: function(error) {
                        alert('Error: ' + error.responseText);
                    }
                });
            } else {
                alert('Please fill out all required fields.');
            }
        }

        function showStudents() {
            const semester = $('#showSemester').val();

            if (semester) {
                $.ajax({
                    url: `${serverUrl}/students/${semester}`,
                    type: 'GET',
                    success: function(students) {
                        $('#studentList tbody').empty();  // Clear previous list
                        if (students.length > 0) {
                            students.forEach(student => {
                                $('#studentList tbody').append(`
                                    <tr>
                                        <td>${student.studentId}</td>
                                        <td>${student.studentName}</td>
                                        <td>${student.semester}</td>
                                        <td>${student.phone_number}</td>
                                        <td>${student.email}</td>
                                        <td>${student.dob}</td>
                                        <td>${student.gender}</td>
                                    </tr>
                                `);
                            });
                        } else {
                            $('#studentList tbody').append('<tr><td colspan="7">No students found for this semester.</td></tr>');
                        }
                    },
                    error: function(error) {
                        alert('Error: ' + error.responseText);
                    }
                });
            } else {
                alert('Please select a semester.');
            }
        }
    </script>

</body>
</html>
