
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>BLDEACET| Faculty</title>
    <!--Style Starts-->
    <link rel="icon" type="image/png" href="img/IIITV_Logo_1x1_small.png">
    <link href='https://fonts.googleapis.com/css?family=Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="n.css">
    <style>
        .faculty-photo {
            max-width: 100%;
            max-height: 150px; /* Adjust height as needed */
            height: auto;
            border-radius: 50%; /* Optional: makes images circular */
        }
    </style>
</head>

<body>
    <!-- Start Your Body Code From here -->
    <div class="wrapper">
        <!-- header starts here -->
        <header id="header" class="">
            <!-- header -->
            <div class="header-wrapper">
                <div class="header-container">
                    <div>
                        <div class="logo-name">
                            <div class="logo"><a href="index.html" title=""><img src="https://github.com/prajwaldiggavi/BlDE/blob/image/BLD.png?raw=true
"
                                                                                 alt="logo"></a></div>
                            <div class="name">
                                <a href="index.html" title="">
                                    <h5>DEPARTMENT OF INFORMATION SCINCE AND ENGINEERING</h5>
                                    <h5 class="primary-color">BLDEACET</h5>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="header-links">
                        <a href="https://www.google.com/maps?ll=16.847732,75.718501&z=17&t=m&hl=en&gl=IN&mapclient=embed&cid=6385882878560726955" target="_blank" title="Open in Google Maps">
                            <i class="fa fa-map-marker fa-lg" style="color: #FF5733;" aria-hidden="true"></i>
                        </a>
                    
                        <a href="#" data-toggle="popover" title="Phone No." data-content="+91-79-29750281"
                           data-placement="bottom"><i class="fa fa-phone fa-lg" aria-hidden="true"></i></a>
                           <a href="https://www.youtube.com/@bldeacetmedia7621" target="_blank" title="YouTube">
                            <i class="fa fa-youtube fa-lg" style="color: #FF0000;" aria-hidden="true"></i>
                        </a>
                    
                        <!-- Social Media Links with Colored Logos -->
                        <a href="https://www.instagram.com/bldeacetmedia/" target="_blank" title="Instagram">
                            <i class="fa fa-instagram fa-lg" style="color: #C13584;" aria-hidden="true"></i>
                        </a>
                        <a href="https://x.com/i/flow/login?redirect_after_login=%2Fbldeacet" target="_blank" title="Twitter">
                            <i class="fa fa-twitter fa-lg" style="color: #1DA1F2;" aria-hidden="true"></i>
                        </a>
                        
                    </div>
                    
                </div>
            </div>
            <nav>
                <nav>
                    <div class="navbar navbar-inverse navbar-custom" role="navigation">
                        <div class="container">
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                            </div>
                            <div class="collapse navbar-collapse">
                                <ul class="nav navbar-nav">
                                    <li><a href="student_details.html">Student Details Entry</a></li>
    
                                    <li>
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">People <b class="caret"></b></a>
                                        <ul class="dropdown-menu multi-level">
                                            <li><a href="faculty.html">Faculty</a></li>
                                            <li><a href="visiting_faculty.html">Visiting Faculty</a></li>
                                            <li><a href="staff.html">Staff</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
                                        <ul class="dropdown-menu multi-level">
                                            <li><a href="#">FAQs</a></li>
                                            <li><a href="#">Student's Corner</a></li>
                                            <li><a href="#" target="_blank">Moodle</a></li>
                                            <li><a href="#">Library</a></li>
                                            <li><a href="#">Invited Talks</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="career.html">Career</a></li>
                                    <li><a href="gallery.html">Photo Gallery</a></li>
                                    <li><a href="attend2.html">Attendance</a></li> <!-- New Attendance Link -->
                                    <li><a href="marks_entry.html">Marks Entry</a></li> <!-- New Marks Entry Link -->
                                </ul>
                            </div>
                            <!--/.nav-collapse -->
                        </div>
                    </div>
                </nav>
                
        </header>
        <style>
            h2 {
                font-size: 24px;
                color: #d32f2f;
                font-weight: bold;
                text-align: center;
                margin-bottom: 20px;
            }
        
            select, input[type="date"], input[type="text"] {
                font-size: 16px;
                padding: 8px 10px;
                width: 100%;
                border: 1px solid #ddd;
                border-radius: 5px;
                margin-bottom: 15px;
            }
        
            label {
                font-size: 16px;
                color: #444;
                font-weight: bold;
                display: block;
                margin-bottom: 5px;
            }
        
            #studentsList li {
                display: flex;
                justify-content: space-between;
                padding: 10px;
                border-bottom: 1px solid #e0e0e0;
                font-size: 16px;
                color: #333;
            }
        
            .student-actions button {
                font-size: 14px;
                padding: 10px 15px;
                border-radius: 5px;
                font-weight: bold;
                color: #ffffff;
                cursor: pointer;
                transition: background-color 0.3s ease, transform 0.3s ease;
                border: none;
            }
        
            /* Green for Present button */
            .present-btn {
                background-color: #4caf50;
            }
        
            /* Red for Absent button */
            .absent-btn {
                background-color: #f44336;
                display: none;
            }
        
            .student-actions button:hover {
                opacity: 0.9;
                transform: translateY(-2px);
            }
        
            /* Button hover effects */
            .present-btn:hover {
                background-color: #388e3c;
            }
        
            .absent-btn:hover {
                background-color: #d32f2f;
            }
        
            button {
                font-size: 16px;
                padding: 10px 20px;
                border: none;
                border-radius: 5px;
                font-weight: bold;
                color: #ffffff;
                margin-right: 10px;
                cursor: pointer;
                transition: background-color 0.3s ease, transform 0.3s ease;
            }
        
            /* Submit button style */
            button[type="submit"] {
                background-color: #4caf50;
            }
        
            /* Export button style */
            button[type="button"] {
                background-color: #ff9800;
            }
        
            /* Hover effect for buttons */
            button[type="submit"]:hover {
                background-color: #388e3c;
                transform: translateY(-2px);
            }
        
            button[type="button"]:hover {
                background-color: #e65100;
                transform: translateY(-2px);
            }
        
            #resultSection, #statsSection, #attendanceDetail {
                display: none;
                margin-top: 20px;
                padding: 20px;
                border-radius: 8px;
                color: #ffffff;
            }
        
            #resultSection {
                background-color: #4caf50;
            }
        
            #statsSection {
                background-color: #009688;
            }
        
            #attendanceDetail {
                background-color: #9e9e9e;
            }
        
            #attendanceDetailsDisplay {
                font-size: 16px;
                line-height: 1.5;
            }
        
            /* Responsive Design */
            @media (max-width: 768px) {
                /* Adjust inputs and buttons for smaller screens */
                select, input[type="date"], input[type="text"] {
                    font-size: 14px;
                    padding: 6px 8px;
                }
        
                button {
                    width: 100%;
                    font-size: 18px;
                    padding: 12px 20px;
                }
        
                button[type="submit"], button[type="button"] {
                    width: 100%;
                    font-size: 18px;
                    padding: 12px 20px;
                }
        
                #studentsList li {
                    font-size: 14px;
                    padding: 8px;
                }
        
                h2, h3 {
                    font-size: 22px;
                }
            }
        
            @media (max-width: 480px) {
                /* Even smaller screens */
                h2, h3 {
                    font-size: 18px;
                }
        
                label {
                    font-size: 14px;
                }
        
                select, input[type="date"], input[type="text"] {
                    font-size: 14px;
                    padding: 5px 8px;
                }
        
                .student-actions button {
                    padding: 8px 15px;
                    font-size: 14px;
                }
            }
        </style>
        
    </head>
    
    <body>
        <div class="container">
            <h2>Student Attendance Portal</h2>
            
            <!-- Subject Name Input -->
            <label for="subjectName">Subject Name:</label>
            <input type="text" id="subjectName" placeholder="Enter subject name" required>
            
            <!-- Semester Selector -->
            <label for="classSelector">Semester:</label>
            <select id="classSelector" onchange="fetchStudents()">
                <option value="">Select Semester</option>
                <option value="1">1st Semester</option>
                <option value="2">2nd Semester</option>
                <option value="3">3rd Semester</option>
                <option value="4">4th Semester</option>
                <option value="5">5th Semester</option>
                <option value="6">6th Semester</option>
                <option value="7">7th Semester</option>
                <option value="8">8th Semester</option>
            </select>
            
            <!-- Student List -->
            <h3>Student List</h3>
            <ul id="studentsList"></ul>
            
            <!-- Attendance Date Input -->
            <label for="attendanceDate">Attendance Date:</label>
            <input type="date" id="attendanceDateInput" required>
            
            <!-- Submit and Export Buttons -->
            <button type="submit" onclick="submitAttendance()">Submit Attendance</button>
            <button type="button" onclick="exportAttendance()">Export Attendance</button>
            
            <!-- Attendance Statistics Section -->
            <div>
    <h2>Attendance Stats</h2>
    <p>Total Students: <span id="totalStudentsDisplay">0</span></p>
    <p>Present: <span id="presentCountDisplay">0</span></p>
    <p>Absent: <span id="absentCountDisplay">0</span></p>
</div>

<div>
    <h2>Attendance Report</h2>
    <p id="attendanceDetailsDisplay">No attendance records yet.</p>
</div>

            
            <!-- Result Section -->
            <div id="resultSection" class="result-section">
                <h3>Attendance Result</h3>
                <p>Date: <span id="attendanceDateDisplay"></span></p>
                <p>Time: <span id="attendanceTimeDisplay"></span></p>
            </div>
            
            <!-- Retrieve Attendance Section -->
            <h3>Retrieve Attendance</h3>
            <label for="studentIdInput">Student ID:</label>
            <input type="text" id="studentIdInput" placeholder="Enter Student ID" required>
            
            <label for="subjectNameRetrieve">Subject Name:</label>
            <input type="text" id="subjectNameRetrieve" placeholder="Enter Subject Name" required>
            
            <button type="button" onclick="fetchAttendance()">Fetch Attendance</button>
            
            <div id="attendanceDetail" class="attendance-detail">
                <h3>Attendance Details</h3>
                <p id="attendanceDetailsDisplay">Student ID: undefined<br>Subject: undefined<br>Classes Attended: undefined<br>Dates: undefined</p>
            </div>
<script>
const BACKEND_URL = "https://blde-production.up.railway.app"; // Replace with your Railway backend URL

// Fetch students based on the selected semester
async function fetchStudents() {
    const semester = document.getElementById("classSelector").value;
    const studentsList = document.getElementById("studentsList");
    studentsList.innerHTML = ''; // Clear previous list

    if (!semester) {
        alert("Please select a semester.");
        return;
    }

    try {
        const response = await fetch(`${BACKEND_URL}/students/${semester}`);
        if (!response.ok) throw new Error(`Server error: ${response.status}`);

        const students = await response.json();
        students.forEach(student => {
            const li = document.createElement('li');
            li.innerHTML = `    
                ${student.studentName} (ID: ${student.studentId})
                <div class="student-actions">
                    <button class="present-btn" data-roll="${student.studentId}" onclick="toggleAttendance(this, true)">Present</button>
                    <button class="absent-btn" data-roll="${student.studentId}" onclick="toggleAttendance(this, false)">Absent</button>
                </div>
            `;
            studentsList.appendChild(li);
        });
    } catch (error) {
        console.error('Error fetching students:', error);
        alert("Failed to fetch students.");
    }
}

// Submit attendance for the selected date and subject
async function submitAttendance() {
    const subjectName = document.getElementById("subjectName").value;
    const dateInput = document.getElementById("attendanceDateInput").value;
    const semester = document.getElementById("classSelector").value;

    if (!subjectName || !dateInput || !semester) {
        alert("Please fill all fields before submitting.");
        return;
    }

    const studentsList = document.querySelectorAll("#studentsList li");
    const attendance = [];

    studentsList.forEach(studentItem => {
        const rollNumber = studentItem.querySelector(".present-btn").dataset.roll;
        const isPresent = studentItem.querySelector(".present-btn").style.display === "none" ? "Present" : "Absent";
        attendance.push({ roll_number: rollNumber, status: isPresent });
    });

    try {
        const response = await fetch(`${BACKEND_URL}/attendance`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ date: dateInput, subjectName, semester, attendance }),
        });

        if (!response.ok) throw new Error("Error saving attendance.");

        alert("Attendance submitted successfully.");
        updateAttendanceStats(semester, subjectName, dateInput);
    } catch (error) {
        console.error("Error submitting attendance:", error);
        alert("Failed to submit attendance.");
    }
}

// Update attendance statistics for the current session (specific date, subject)
async function updateAttendanceStats(semester, subjectName, date) {
    try {
        const response = await fetch(`${BACKEND_URL}/attendance/stats/${semester}/${subjectName}/${date}`);
        if (!response.ok) throw new Error(`Error fetching attendance statistics: ${response.status}`);

        const stats = await response.json();
        document.getElementById("totalStudentsDisplay").textContent = stats.totalStudents;
        document.getElementById("presentCountDisplay").textContent = stats.presentCount;
        document.getElementById("absentCountDisplay").textContent = stats.absentCount;
    } catch (error) {
        console.error("Error fetching attendance statistics:", error);
        alert("Failed to fetch attendance statistics.");
    }
}

// Fetch attendance for a specific student and subject
async function fetchAttendance() {
    const studentId = document.getElementById("studentIdInput").value;
    const subjectName = document.getElementById("subjectNameRetrieve").value;

    if (!studentId || !subjectName) {
        alert("Please enter both Student ID and Subject Name.");
        return;
    }

    try {
        const response = await fetch(`${BACKEND_URL}/attendance/${studentId}/${subjectName}`);
        if (!response.ok) throw new Error(`Server error: ${response.status}`);

        const attendanceRecords = await response.json();
        if (attendanceRecords.length === 0) {
            document.getElementById("attendanceDetailsDisplay").innerHTML = "No attendance records found.";
            return;
        }

        let attendedClasses = 0;
        let dates = [];
        attendanceRecords.forEach(record => {
            if (record.status === "Present") attendedClasses++;
            dates.push(record.date);
        });

        document.getElementById("attendanceDetailsDisplay").innerHTML = `
            Student ID: ${studentId}<br>
            Subject: ${subjectName}<br>
            Classes Attended: ${attendedClasses}<br>
            Dates: ${dates.join(', ')}
        `;
    } catch (error) {
        console.error("Error fetching attendance:", error);
        alert("Failed to fetch attendance.");
    }
}

// Toggle attendance status (Present/Absent)
function toggleAttendance(button, isPresent) {
    const parentDiv = button.parentElement;
    const presentButton = parentDiv.querySelector(".present-btn");
    const absentButton = parentDiv.querySelector(".absent-btn");

    if (isPresent) {
        presentButton.style.display = "none"; // Hide present button
        absentButton.style.display = "inline-block"; // Show absent button
        absentButton.textContent = "Absent";  // Set status to Absent
    } else {
        presentButton.style.display = "inline-block"; // Show present button
        absentButton.style.display = "none"; // Hide absent button
        presentButton.textContent = "Present";  // Set status to Present
    }
}
</script>

    </body>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <p>&copy; BLDEACET DEPT OF ISE.</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- /Footer -->
</div>

    <!-- /wrapper -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</body>

</html>
